// prisma cheat sheet: https://github.com/emanuelefavero/prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            Int      @id @default(autoincrement())
  clerk_id      String   @unique
  hasPlan       Boolean  @default(false)
  plan          String?  @default("hobby")
  credits       Int?     @default(0)
  hasFirstModel Boolean  @default(false)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

enum ModelStatus {
  PENDING
  TRAINING
  COMPLETED
  FAILED
}

model MLModel {
  id                Int         @id @default(autoincrement())
  user_id           String // clerk user_id
  name              String?
  stylePrompt       String?
  imageUrls         String[]
  sampleUrls        String[]
  trainId           String?
  baseModel         String?
  destination       String?
  modelStatus       ModelStatus @default(PENDING)
  tword             String?
  modelHostId       String?
  completedTraining Boolean     @default(false)
  agreedToTerms     Boolean     @default(false)
  createdAt         DateTime    @default(now())
  updatedAt         DateTime    @updatedAt
  aiphotos          AIPhoto[]
}

model AIPhoto {
  id         Int      @id @default(autoincrement())
  user_id    String // clerk user_id
  url        String
  modelId    Int?
  model      MLModel? @relation(fields: [modelId], references: [id])
  favourited Boolean  @default(false)
  deleted    Boolean  @default(false) // will use as "soft delete"
  prompt     String?
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
}
